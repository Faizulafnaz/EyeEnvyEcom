{% load static %}
<!DOCTYPE html>
<!-- Designined by CodingLab - youtube.com/codinglabyt -->
<html lang="en" dir="ltr">
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <meta charset="UTF-8">
    <title> Responsive Registration Form | CodingLab </title>
    <link rel="stylesheet" href="/static/css/stylesignup.css">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
   </head>
<body>
{% if otp %}
<div class="container">
  <div class="title">E-mail OTP verification</div>
  <p class="text-center">check your mail for otp</p>
  <div class="content">
    <form method="post" action="{% url 'signup' %}">
      {% csrf_token %}
      {% if messages%}
                      {% for message in messages%}
                      <div class="alert alert-warning alert-dismissible fade show" role="alert">
                        <strong></strong>{{message}}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                      </div>
                      {%endfor%}
                      {%endif%} 
      <div class="user-details">
        <div class="input-box">
          <input  type="hidden" name="email" value="{{usr.email}}">
        </div>
        <div class="input-box">
          <input required minlength="4" maxlength="4" type="text" class="form-control" id="name" name="otp" placeholder="Enter Your OTP" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Your OTP'">
        </div>
      <div class="button">
        <input type="submit" value="Confirm OTP">
      </div>
    </div>
    </form>
  </div>
</div>
{% else %}
  <div class="container">
    <div class="title">Registration</div>
    <div class="content">
      <form method="post" action="{% url 'signup' %}" onsubmit = "return btnClick()">
        {% csrf_token %}
        {% if messages%}
        {% for message in messages%}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
          <strong></strong>{{message}}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {%endfor%}
        {%endif%}
        <div class="user-details">
          <div class="input-box">
            <span class="details">First Name</span>
            <input type="text" placeholder="Enter your first name" name="fname" id = "fname"required>
          </div>
          <div class="input-box">
            <span class="details">Last Name</span>
            <input type="text" placeholder="Enter your last name" name="lname" id = "lname"required>
          </div>
          <div class="input-box">
            <span class="details">Username</span>
            <input type="text" placeholder="Enter your username" name="username" id = "username" required>
          </div>
          <div class="input-box">
            <span class="details">Email</span>
            <input type="email" placeholder="Enter your email" name="email" id = "email" required>
          </div>
          <div class="input-box">
            <span class="details">Phone Number</span>
            <input type="tel" placeholder="Enter your number" name="phno" required>
          </div>
          <div class="input-box">
            <span class="details">Password</span>
            <input type="password" placeholder="Enter your password" name="pass1" id = "pass1"required>
          </div>
          <div class="input-box">
            <span class="details">Confirm Password</span>
            <input type="password" placeholder="Confirm your password" name="pass2" required>
          </div>
        </div>
        <div class="signup-link">
          Already a member? <a href="{% url 'handlelogin' %}">Login now</a>
       </div>
        <div class="button">
          <input type="submit" value="Register">
        </div>
      </form>
    </div>
  </div>
  {% endif %}

  <script>
    // =====Formvaladation=====
  
  function btnClick(){
    
      let staus = true
  
      var Name =document.getElementById("fname").value.trim()
      var lname =document.getElementById("lname").value.trim()
      var username =document.getElementById("username").value.trim()
      var mail=document.getElementById("email").value.trim()
      var password=document.getElementById("pass1").value.trim()
      
      if(Name===""||mail===""||username===""||lname===""||password==="")
      {
          alert("Please fill all fields")
          staus=false
      }else if(!/^([a-zA-Z0-9\_.]+)@([a-zA-Z0-9]+).([a-z]+).([a-z]+)?$/.test(mail)){
          alert("Please re-check at email")
          staus=false
       }
      return staus;
  
  }
  
  </script>
  

</body>
</html>
